{"version":3,"sources":["webpack:///./assets/js/theme/product.js","webpack:///./assets/js/theme/product/reviews.js","webpack:///./assets/js/theme/product/video-gallery.js"],"names":["Product","context","url","window","location","href","$reviewLink","$","$bulkPricingLink","onReady","validator","document","on","indexOf","history","replaceState","title","pathname","collapsibleFactory","console","log","this","productDetails","ProductDetails","BCData","product_attributes","setProductVariant","videoGallery","$reviewForm","classifyForm","review","Review","registerValidation","performCheck","areAll","productReviewHandler","bulkPricingHandler","trigger","PageManager","nod","submit","find","$reviewsContent","$collapsible","initLinkBind","injectPaginationLink","collapseReviews","$content","hasClass","CollapsibleEvents","click","hash","$nextLink","$prevLink","length","attr","add","selector","validate","errorMessage","reviewRating","reviewSubject","reviewComment","cb","val","forms","email","reviewEmail","VideoGallery","$element","$player","$videos","currentVideo","bindEvents","selectNewVideo","e","preventDefault","$target","currentTarget","id","data","$selectedThumb","setMainVideo","setActiveThumb","removeClass","addClass","bind","each","index","element","$el"],"mappings":"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","file":"theme-bundle.chunk.2.js","sourcesContent":["/*\n Import all product specific js\n */\nimport PageManager from './page-manager';\nimport Review from './product/reviews';\nimport collapsibleFactory from './common/collapsible';\nimport ProductDetails from './common/product-details';\nimport videoGallery from './product/video-gallery';\nimport { classifyForm } from './common/form-utils';\n\nexport default class Product extends PageManager {\n    constructor(context) {\n        super(context);\n        this.url = window.location.href;\n        this.$reviewLink = $('[data-reveal-id=\"modal-review-form\"]');\n        this.$bulkPricingLink = $('[data-reveal-id=\"modal-bulk-pricing\"]');\n    }\n\n    onReady() {\n        // Listen for foundation modal close events to sanitize URL after review.\n        $(document).on('close.fndtn.reveal', () => {\n            if (this.url.indexOf('#write_review') !== -1 && typeof window.history.replaceState === 'function') {\n                window.history.replaceState(null, document.title, window.location.pathname);\n            }\n        });\n\n        let validator;\n\n        // Init collapsible\n        collapsibleFactory();\n        console.log(this.context);\n        this.productDetails = new ProductDetails($('.productView'), this.context, window.BCData.product_attributes);\n        this.productDetails.setProductVariant();\n\n        videoGallery();\n\n        const $reviewForm = classifyForm('.writeReview-form');\n        const review = new Review($reviewForm);\n\n        $('body').on('click', '[data-reveal-id=\"modal-review-form\"]', () => {\n            validator = review.registerValidation(this.context);\n        });\n\n        $reviewForm.on('submit', () => {\n            if (validator) {\n                validator.performCheck();\n                return validator.areAll('valid');\n            }\n\n            return false;\n        });\n\n        this.productReviewHandler();\n        this.bulkPricingHandler();\n    }\n\n    productReviewHandler() {\n        if (this.url.indexOf('#write_review') !== -1) {\n            this.$reviewLink.trigger('click');\n        }\n    }\n    bulkPricingHandler() {\n        if (this.url.indexOf('#bulk_pricing') !== -1) {\n            this.$bulkPricingLink.trigger('click');\n        }\n    }\n}\n","import nod from '../common/nod';\nimport { CollapsibleEvents } from '../common/collapsible';\nimport forms from '../common/models/forms';\n\nexport default class {\n    constructor($reviewForm) {\n        this.validator = nod({\n            submit: $reviewForm.find('input[type=\"submit\"]'),\n        });\n\n        this.$reviewsContent = $('#product-reviews');\n        this.$collapsible = $('[data-collapsible]', this.$reviewsContent);\n\n        this.initLinkBind();\n        this.injectPaginationLink();\n        this.collapseReviews();\n    }\n\n    /**\n     * On initial page load, the user clicks on \"(12 Reviews)\" link\n     * The browser jumps to the review page and should expand the reviews section\n     */\n    initLinkBind() {\n        const $content = $('#productReviews-content', this.$reviewsContent);\n\n        $('.productView-reviewLink').on('click', () => {\n            $('.productView-reviewTabLink').trigger('click');\n            if (!$content.hasClass('is-open')) {\n                this.$collapsible.trigger(CollapsibleEvents.click);\n            }\n        });\n    }\n\n    collapseReviews() {\n        // We're in paginating state, do not collapse\n        if (window.location.hash && window.location.hash.indexOf('#product-reviews') === 0) {\n            this.$collapsible.trigger(CollapsibleEvents.click);\n        }\n\n        // force collapse on page load\n      //  this.$collapsible.trigger(CollapsibleEvents.click);\n    }\n\n    /**\n     * Inject ID into the pagination link\n     */\n    injectPaginationLink() {\n        const $nextLink = $('.pagination-item--next .pagination-link', this.$reviewsContent);\n        const $prevLink = $('.pagination-item--previous .pagination-link', this.$reviewsContent);\n\n        if ($nextLink.length) {\n            $nextLink.attr('href', `${$nextLink.attr('href')} #product-reviews`);\n        }\n\n        if ($prevLink.length) {\n            $prevLink.attr('href', `${$prevLink.attr('href')} #product-reviews`);\n        }\n    }\n\n    registerValidation(context) {\n        this.context = context;\n        this.validator.add([{\n            selector: '[name=\"revrating\"]',\n            validate: 'presence',\n            errorMessage: this.context.reviewRating,\n        }, {\n            selector: '[name=\"revtitle\"]',\n            validate: 'presence',\n            errorMessage: this.context.reviewSubject,\n        }, {\n            selector: '[name=\"revtext\"]',\n            validate: 'presence',\n            errorMessage: this.context.reviewComment,\n        }, {\n            selector: '[name=\"email\"]',\n            validate: (cb, val) => {\n                const result = forms.email(val);\n                cb(result);\n            },\n            errorMessage: this.context.reviewEmail,\n        }]);\n\n        return this.validator;\n    }\n\n    validate() {\n        return this.validator.performCheck();\n    }\n}\n","export class VideoGallery {\n    constructor($element) {\n        this.$player = $element.find('[data-video-player]');\n        this.$videos = $element.find('[data-video-item]');\n        this.currentVideo = {};\n        this.bindEvents();\n    }\n\n    selectNewVideo(e) {\n        e.preventDefault();\n\n        const $target = $(e.currentTarget);\n\n        this.currentVideo = {\n            id: $target.data('videoId'),\n            $selectedThumb: $target,\n        };\n\n        this.setMainVideo();\n        this.setActiveThumb();\n    }\n\n    setMainVideo() {\n        this.$player.attr('src', `//www.youtube.com/embed/${this.currentVideo.id}`);\n    }\n\n    setActiveThumb() {\n        this.$videos.removeClass('is-active');\n        this.currentVideo.$selectedThumb.addClass('is-active');\n    }\n\n    bindEvents() {\n        this.$videos.on('click', this.selectNewVideo.bind(this));\n    }\n}\n\nexport default function videoGallery() {\n    const pluginKey = 'video-gallery';\n    const $videoGallery = $(`[data-${pluginKey}]`);\n\n    $videoGallery.each((index, element) => {\n        const $el = $(element);\n        const isInitialized = $el.data(pluginKey) instanceof VideoGallery;\n\n        if (isInitialized) {\n            return;\n        }\n\n        $el.data(pluginKey, new VideoGallery($el));\n    });\n}\n"],"sourceRoot":""}