{"version":3,"sources":["../../../../src/payment/v1/payment-mappers/order-mapper.js"],"names":["OrderMapper","data","order","billing_address","mapToBillingAddress","coupons","mapToCoupons","currency","id","orderId","items","mapToItems","shipping","mapToShipping","shipping_address","mapToShippingAddress","token","totals","mapToOrderTotals","customer","address","mapToAddress","email","shippingOption","description","method","coupon","map","code","addressKey","city","company","country_code","countryCode","country","first_name","firstName","last_name","lastName","phone","state_code","provinceCode","state","province","street_1","addressLine1","street_2","addressLine2","zip","postCode","cart","itemData","variant_id","variantId","name","price","integerAmount","quantity","sku","grand_total","grandTotal","handling","subtotal","tax","taxTotal"],"mappings":"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","file":"order-mapper.js","sourcesContent":["import { omitEmptyStringAndNil, omitNil, toString } from '../../../common/utils';\n\nexport default class OrderMapper {\n    /**\n     * @returns {OrderMapper}\n     */\n    static create() {\n        return new OrderMapper();\n    }\n\n    /**\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToOrder(data) {\n        const { order = {} } = data;\n\n        return omitNil({\n            billing_address: this.mapToBillingAddress(data),\n            coupons: this.mapToCoupons(data),\n            currency: order.currency,\n            id: order.orderId ? toString(order.orderId) : null,\n            items: this.mapToItems(data),\n            shipping: this.mapToShipping(data),\n            shipping_address: this.mapToShippingAddress(data),\n            token: order.token,\n            totals: this.mapToOrderTotals(data),\n        });\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToBillingAddress(data) {\n        const { customer = {} } = data;\n        const address = this.mapToAddress(data, 'billingAddress');\n\n        if (customer.email) {\n            address.email = customer.email;\n        }\n\n        return address;\n    }\n\n    /**\n     * @private\n     * @param  {PaymentRequestData} data\n     * @return {Shipping[]}\n     */\n    mapToShipping(data) {\n        const { description } = data.shippingOption || {};\n\n        if (description) {\n            return [{\n                method: description,\n            }];\n        }\n\n        return [];\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @returns {Coupon[]}\n     */\n    mapToCoupons({ order = {} }) {\n        if (order.coupon && order.coupon.coupons) {\n            return order.coupon.coupons.map(({ code }) => ({ code }));\n        }\n\n        return [];\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToShippingAddress(data) {\n        return this.mapToAddress(data, 'shippingAddress');\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @param {string} addressKey\n     * @returns {Object}\n     */\n    mapToAddress(data, addressKey) {\n        const address = data[addressKey] || {};\n\n        return omitEmptyStringAndNil({\n            city: address.city,\n            company: address.company,\n            country_code: address.countryCode,\n            country: address.country,\n            first_name: address.firstName,\n            last_name: address.lastName,\n            phone: address.phone,\n            state_code: address.provinceCode,\n            state: address.province,\n            street_1: address.addressLine1,\n            street_2: address.addressLine2,\n            zip: address.postCode,\n        });\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToItems(data) {\n        const { cart = { items: [] } } = data;\n\n        return cart.items.map(itemData => omitNil({\n            code: itemData.id,\n            variant_id: itemData.variantId,\n            name: itemData.name,\n            price: itemData.integerAmount,\n            quantity: itemData.quantity,\n            sku: itemData.sku,\n        }));\n    }\n\n    /**\n     * @private\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToOrderTotals(data) {\n        const { order = {} } = data;\n\n        return omitNil({\n            grand_total: order.grandTotal ? order.grandTotal.integerAmount : null,\n            handling: order.handling ? order.handling.integerAmount : null,\n            shipping: order.shipping ? order.shipping.integerAmount : null,\n            subtotal: order.subtotal ? order.subtotal.integerAmount : null,\n            tax: order.taxTotal ? order.taxTotal.integerAmount : null,\n        });\n    }\n}\n"]}